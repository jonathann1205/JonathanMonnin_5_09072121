let panierClient=JSON.parse(localStorage.getItem("produit"));function affichagePanier(){if(null==panierClient)document.querySelector(".pagePanier").style.display="none";else{document.querySelector(".panierVide").style.display="none";let affichagePanier="";for(let list of panierClient)affichagePanier+=` \n        <tr>\n            \n            <td>${list.nomProduit}</td>\n            <td>${list.lentilleChoisi}</td>\n            <td>${list.quantite}</td>\n            <td class="prix">${list.prix}</td>\n           \n      </tr>\n     \n      `;document.querySelector(".produit").innerHTML=affichagePanier}}function totalPanierClient(){let totalPanier=[];for(let i=0;i<panierClient.length;i++){let PrixClient=panierClient[i].prix;totalPanier.push(PrixClient);const reducer=(accumlator,currentValue)=>accumlator+currentValue,prixTotalPanier=totalPanier.reduce(reducer,0);let affichagePrixTotal=`\n                        <p class="fs-4 col-6 col-sm-4 ps-3 "><strong> Total </strong></p>\n                        <p class="fs-4  text-center  col-6 col-sm-4 ps-5 ">${prixTotalPanier}</p>\n                        `;document.querySelector(".total").innerHTML=affichagePrixTotal}}function vidagePanier(){localStorage.clear(),document.location.reload(),console.log("localStorage vidÃ©")}affichagePanier(),totalPanierClient(),validiteForm();const btnVidePanier=document.querySelector("#btnViderPanier");function validiteForm(){var forms=document.querySelectorAll(".needs-validation");Array.prototype.slice.call(forms).forEach((function(form){form.addEventListener("submit",(function(event){form.checkValidity()?(envoiCommande(),localStorage.clear(),event.preventDefault(),event.stopPropagation(),console.log("ok")):(event.preventDefault(),event.stopPropagation()),form.classList.add("was-validated")}),!1)}))}btnVidePanier.addEventListener("click",(function(){vidagePanier()}));let panierId=[];if(null==!panierClient)for(let list of panierClient)panierId.push(list.idProduit);function envoiCommande(){let nom=document.querySelector("#nomForm").value,prenom=document.querySelector("#prenomForm").value,email=document.querySelector("#EmailForm").value,address,ville,codePostal,donneClient={contact:{firstName:nom,lastName:prenom,address:document.querySelector("#AddressForm").value,city:document.querySelector("#villeForm").value+""+document.querySelector("#codePostalForm").value,email:email},products:panierId};console.log(JSON.stringify(donneClient));const requestOptions={method:"POST",body:JSON.stringify(donneClient),headers:{"Content-Type":"application/json; charset=utf-8"}};fetch("http://localhost:3000/api/cameras/order",requestOptions).then(response=>response.json()).then(data=>{window.location.href=`${window.location.origin}/confirmation.html?orderId=${data.orderId}`}).catch(error=>console.log("erreur de type : ",error))}